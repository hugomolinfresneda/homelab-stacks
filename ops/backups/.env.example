# --- Paths (shell-sourced; literal values, no env-file expansion) ---
# Placeholders:
# STACKS_DIR=<ABS_PATH_TO_STACKS_DIR>
# RUNTIME_ROOT=<ABS_PATH_TO_RUNTIME_ROOT>
# RUNTIME_DIR is derived: <ABS_PATH_TO_RUNTIME_ROOT>/stacks/<stack>

# --- Restic ---
export BACKUPS_DIR="<ABS_PATH_TO_BACKUPS_DIR>"          # base mount for local backup storage
export RESTIC_REPOSITORY="${BACKUPS_DIR}/homelab-restic" # or s3:..., b2:..., rclone:...
export RESTIC_PASSWORD="CHANGE_ME"
# Retention policy
export RESTIC_KEEP_DAILY=7
export RESTIC_KEEP_WEEKLY=4
export RESTIC_KEEP_MONTHLY=6
# Grouping for retention (optional; e.g. "host" or "host,tags")
# export RESTIC_GROUP_BY="host"
# Apply retention after each backup? (1=yes, 0=no)
export RUN_FORGET=1

# Exclusions
# Prefer this var name (singular). The script also accepts EXCLUDE_FILE and legacy RESTIC_EXCLUDES_FILE.
export RESTIC_EXCLUDE_FILE="<ABS_PATH_TO_STACKS_DIR>/ops/backups/exclude.txt"

# Prometheus textfile collector (optional)
# Default is /var/lib/node_exporter/textfile_collector
# export BACKUP_TEXTFILE_DIR="<ABS_PATH_TO_TEXTFILE_COLLECTOR_DIR>"

# Uptime Kuma (Push monitor)
export KUMA_PUSH_URL="https://uptime-kuma.<YOUR_DOMAIN>/api/push/<YOUR_TOKEN>"
# Optional DNS override for Kuma push (force LAN IP when hairpin NAT/DNS breaks)
# export KUMA_RESOLVE_IP="<KUMA_LAN_IP>"

# What to back up (paths may be absent; the script will skip them cleanly)
# NOTE: do NOT put the Nextcloud data volume here; use the dedicated nc-backup.sh flow.
BACKUP_PATHS=(
  # Public infra (scripts, ops, etc.)
  "<ABS_PATH_TO_STACKS_DIR>/ops"

  # CouchDB (bind)
  "<ABS_PATH_TO_RUNTIME_ROOT>/stacks/couchdb/data"

  # Nextcloud backup artifacts (sql+tar+.sha256), not the data volume
  "${BACKUPS_DIR}/nextcloud"

  # Uptime Kuma data (bind)
  "<ABS_PATH_TO_RUNTIME_ROOT>/stacks/uptime-kuma/data"
)
