groups:
- name: adguard.health
  rules:
  - alert: AdGuardExporterDown
    expr: up{job="adguard-exporter"} == 0
    labels:
      severity: warning
      service: adguard
      component: exporter
      scope: lab
    annotations:
      summary: AdGuard exporter is down
      description: Prometheus cannot scrape adguard-exporter (job=adguard-exporter).
    for: 5m
  - alert: AdGuardProtectionDisabled
    expr: protection_enabled{job="adguard-exporter"} == 0
    labels:
      severity: warning
      service: adguard
      component: service
      scope: lab
    annotations:
      summary: AdGuard protection is disabled
      description: AdGuard filtering/protection is disabled.
    for: 10m
  - alert: AdGuardHighLatency
    expr: adguard_avg_processing_time{job="adguard-exporter"} > 0.10
    labels:
      severity: warning
      service: adguard
      component: service
      scope: lab
    annotations:
      summary: AdGuard average processing time is high
      description: adguard_avg_processing_time is above 100ms for 10 minutes. Check upstream DNS and host resources.
    for: 10m
